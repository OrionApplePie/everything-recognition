# Распознавание объектов

Программа [компьютерного зрения](https://xakep.ru/2019/01/14/yandex-ds/) для распознавания объектов в видеопотоке камеры.

В программу включена возможность распознавать: лицо человека в профиль и анфас, улыбку, глаза, тело человека, а также кошачью мордочку.
Есть возможность добавить и другие объекты для распознавания.

Используется библиотека [OpenCV](https://opencv.org/about/) для [Python](https://opencv.org/opencv-python-is-now-an-official-opencv-project/).

Больше информации: https://github.com/opencv/opencv-python.

## Требования

Должно быть установлены следующее ПО:

- [Python 3.x](https://www.python.org/)
- [Git](https://git-scm.com/download)

Также необходимо наличие подключенной к компьютеру камеры (веб-камеры).

Опционально: для Windows удобно использовать:

- [GitHub Desktop](https://desktop.github.com/) &mdash; gui для git.
- [Cmdr](https://cmder.net/) &mdash; удобная замена стандартной командной строке Windows.

## Как установить

Скопируйте репозиторий. В терминале выполните команду:

```shell
git clone https://github.com/OrionApplePie/everything-recognition
```

После чего репозиторий скачается и будет доступен локально.

Далее перейдите в папку с репозиторием, и используйте `pip` (или `pip3`, если есть конфликт с Python2) для установки зависимостей:

```shell
pip install -r requirements.txt
```

## Использование

В терминале перейдите в папку с проектом и введите команду:

```shell
python run.py
```

Откроется окно с видеопотоком камеры. Направьте камеру на интересующий Вас объект. 
Если объект распознан, то он будет выделен прямоугольником (рамкой).

Для выхода нажмите клавишу `q`.

## Папка haarcascades

[Каскады Хаара](https://en.wikipedia.org/wiki/Haar-like_feature), содержат признаки (каскады) различных классов объектов для распознавания в виде файлов формата xml:

- лица людей, включая профиль, анфас,
- глаза и улыбку,
- тело целиком,
- мордочка кошки в профиль,
- дорожные знаки,
- бананы и др.

## Файл config.py

Конфигурация признаков. Здесь можно задать классы объектов для распознавания.

Например, настройка для распознавания лица в профиль (`Face profile`):

```python
"Face profile": {
        "path": "haarcascades/faces/haarcascade_profileface.xml",
        "color": (255, 0, 0),
        "draw": True
    },
```

В ключе `path` указывается путь файла каскада, в ключе `color` &ndash; цвет для рамки в формате [BGR](https://stackoverflow.com/a/33787594),
а ключ `draw` определяет, включен ли каскад для распознавания (т.е. будет ли программа искать такие объекты).

Чтобы добавить новый каскад, нужно скопировать файл в папку `haarcascades` и добавить в `config.py` настройку по указанному выше примеру.

## Файл run.py

Основная программа. Содержит вспомогательные функции и основной код.

### is_user_wants_quit

Функция для выхода из программы.

### show_frame

Функция показывает окно с видеопотоком камеры.

### draw_sqare

Функция отрисовки рамки заданного цвета.

### get_cascades

Функция загружает каждый указанные в конфигурационном файле каскады в объекты библиотеки openCV, также загружает настройку цвета рамки.
Берет только указанные для работы каскады (т.е. в конфиге которых указано `"draw": True`).

### Условие if \_\_name\_\_ == "\_\_main\_\_":

Основной код. Здесь происходит само распознавание заданных в конфигурации объектов из видеопотока камеры.

В бесконечном цикле пока пользователь не нажмет клавишу выхода, считывается кадр из видеопотока, применяются каскады для распознавания объектов, найденные выделяются рамками. 

Если не получилось открыть видеопоток, то выводится сообщение "Couldn't find your webcam... Sorry :c", нужно проверить исправность камеры.


## Доп. ресурсы


1. [OpenCV шаг за шагом. Введение.](https://robocraft.ru/blog/computervision/264.html)
2. [Как работают технологии компьютерного зрения и какие задачи они решают](https://press.sber.ru/publications/kak-rabotaiut-tekhnologii-kompiuternogo-zreniia-i-kakie-zadachi-oni-reshaiut)
3. [Python | Haar Cascades for Object Detection](https://www.geeksforgeeks.org/python-haar-cascades-for-object-detection/)
4. [Цифровое видео](https://ru.wikipedia.org/wiki/%D0%A6%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%BE%D0%B5_%D0%B2%D0%B8%D0%B4%D0%B5%D0%BE)
5. [INTLAB- ГЛОССАРИЙ ОСНОВНЫХ ТЕРМИНОВ И ОПРЕДЕЛЕНИЙ](https://www.intlab.com/glossary)
6. [Метод Виолы-Джонса (Viola-Jones) как основа для распознавания лиц](https://habr.com/ru/post/133826/)
7. [Face Detection using Haar Cascades](https://docs.opencv.org/3.1.0/d7/d8b/tutorial_py_face_detection.html#gsc.tab=0)
